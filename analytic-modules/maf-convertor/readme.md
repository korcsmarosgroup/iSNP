## [VCF file structure ](https://docs.gdc.cancer.gov/Data/File_Formats/VCF_Format/#vcf-file-structure)

## Description: 

Convert Mutation Annotation Files (MAF) to Variant C Files (VCF) such that the 
iSNP workflow can process the SNP information. The recommended variant caller for the best 
results is the Mutect2 workflow. However, this tool is compatible with other variant and mutation
calling pipelines. Null and Novel SNPs which do not have a dbSNP ID are removed from the 
analysis. The VCF files will be created with the tumour sample as the filename. 

If the directory structure is not created before the script it run, then in the patient-vcf location
it will be created.

## Commandline:
--maf -m <str, path to the original maf file (.maf)> [mandatory]

--patientvcf -vcf <str, ath to where the patient vcf files should be saved> [mandatory]

--clinical -c <str, a path to where the patient clinical data is being held> [optional] 

--threshold -t <integer value for threshold to filter somatic mutations> [optional]

--reference -r <path to reference file> [optional]

--verbose -v <boolean, whether to display verbose information> [optional, default is False]

### [Metadata header ](https://docs.gdc.cancer.gov/Data/File_Formats/VCF_Format/#metadata-header)

A VCF file starts with lines of metadata that begin with `##`. Some key components of this section include:

- **gdcWorkflow:** Information on the pipelines that were used by the GDC to generate the VCF file. Annotated VCF files contain two *gdcWorkflow* lines, one that reports the variant calling process and one that reports the variant annotation process.

- **INDIVIDUAL**: information about the study participant (`case`), including:
  - *NAME:* Submitter ID (barcode) associated with the participant
  - *ID:* GDC case UUID

- **SAMPLE**: sample information, including:
  - *ID:* NORMAL or TUMOR
  - *NAME:* Submitter ID (barcode) of the aliquot
  - *ALIQUOT_ID:* GDC aliquot UUID
  - *BAM_ID:* The UUID for the BAM file used to produce the VCF

- **INFO**: Format of additional information fields
  - NOTE: GDC Annotated VCFs may contain multiple INFO lines. The last INFO line contains information about annotation fields generated by the [Somatic Annotation Workflow](https://docs.gdc.cancer.gov/Data_Dictionary/viewer/#?view=table-definition-view&id=somatic_annotation_workflow) (see [GDC INFO Fields](https://docs.gdc.cancer.gov/Data/File_Formats/VCF_Format/#gdc-info-fields) below).

- **FILTER:** Description of filters that have been applied to the variants

- **FORMAT:** Description of genotype fields

- **reference:** The reference genome used to generate the VCF file (GRCh38.d1.vd1.fa)

- **contig**: A list of IDs for the contiguous DNA sequences that appear in the reference genome used to produce VCF files
  - NOTE: Annotated VCFs include contig information for autosomes, sex chromosomes, and mitochondrial DNA. Unplaced, unlocalized, human decoy, and viral genome sequences are not included.

- **VEP:** the VEP command used by the [Somatic Annotation Workflow](https://docs.gdc.cancer.gov/Data_Dictionary/viewer/#?view=table-definition-view&id=somatic_annotation_workflow) to generate the annotated VCF file.

### [Column Header Line ](https://docs.gdc.cancer.gov/Data/File_Formats/VCF_Format/#column-header-line)

Each variant is represented by a row in the VCF file. Below each of the columns are described:

1. **CHROM:** The chromosome on which the variant is located
2. **POS:** The position of the variant on the chromosome. Refers to the first position if the variant includes more than one base
3. **ID:** A unique identifier for the variant; usually a dbSNP rs number if applicable
4. **REF:** The base(s) exhibited by the reference genome at the variant's position
5. **ALT:** The alternate allele(s), comma-separated if there are more than one
6. **QUAL:** Not populated
7. **FILTER:** The names of the filters that have flagged this variant. The types of filters used will depend on the variant caller used.
8. **INFO:** Additional information about the variant. This includes the annotation applied by the VEP.
9. **FORMAT:** The format of the sample genotype data in the next two columns. This includes descriptions of the colon-separated values.
10. **NORMAL:** Colon-separated values that describe the normal sample
11. **TUMOR:** Colon-separated values that describe the tumor sample

See [  Variant Call Format (VCF) Version 4.1 Specification](https://samtools.github.io/hts-specs/VCFv4.1.pdf) for details.

#### VCF Genotype Field
GT genotype, encoded as alleles values separated by either of ”/” or “|”, e.g. The allele values are 0 for the reference allele (what is in the reference sequence), 1 for the first allele listed in ALT, 2 for the second allele list in ALT and so on. For diploid calls examples could be 0/1 or 1|0 etc. For haploid calls, e.g. on Y, male X, mitochondrion, only one allele value should be given. All samples must have GT call information; if a call cannot be made for a sample at a given locus, ”.” must be specified for each missing allele in the GT field (for example ./. for a diploid). The meanings of the separators are:

- / : genotype unphased
- | : genotype phased

See: [VCF file genotype information](http://www.internationalgenome.org/wiki/Analysis/Variant%20Call%20Format/vcf-variant-call-format-version-40/) for details.

## MAF File Structure for VCF

### Protected MAF File Structure:

| Column              | Description                                                                                                                                  |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| 122 - vcf_region    | Colon separated string containing the CHROM, POS, ID, REF, and ALT columns from the VCF file (e.g., chrZ:20:rs1234:A:T) (not in somatic MAF) |
| 123 - vcf_info      | INFO column from VCF (not in somatic MAF)                                                                                                    |
| 124 - vcf_format    | FORMAT column from VCF (not in somatic MAF)                                                                                                  |
| 125 - vcf_tumor_gt  | Tumor sample genotype column from VCF (not in somatic MAF)                                                                                   |
| 126 - vcf_normal_gt | Normal sample genotype column from VCF (not in somatic MAF)                                                                                  |